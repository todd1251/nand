(function(){function f(){this.commands=[]}function v(a,b,e,z,f){this.model=a;this.width=b;this.height=e;this.heavyStrokeWidth=z;this.lightStrokeWidth=f;this.labels=[]}function d(a){this.logic=a;this.inputs=[]}function l(a){this.value=a}function c(a,b){this.inputs=a;this.output=b}function m(a){return!a.reduce(function(a,e){return a&&e})}f.prototype.moveTo=function(a,b){this.commands.push("M"+a+","+b);return this};f.prototype.lineTo=function(a,b){this.commands.push("L"+a+","+b);return this};f.prototype.arc=
function(a,b,e,f,c,g,h){this.commands.push("A"+a+","+b+" "+e+" "+f+" "+c+" "+g+","+h);return this};f.prototype.close=function(){this.commands.push("Z");return this};f.prototype.toPath=function(a){return a.path(this.commands.join(" "))};v.prototype.render=function(a,b,e){var c=this.width/2;(new f).moveTo(a,b).lineTo(a+c,b).arc(1,1,0,0,1,a+c,b+this.height).lineTo(a,b+this.height).close().toPath(e).attr("stroke-width",this.heavyStrokeWidth);var d=.05*this.width,g=this.height/2,c=a+c+g+d+this.heavyStrokeWidth/
2,g=b+g;e.circle(c,g,d).attr("stroke-width",this.lightStrokeWidth);var h=.2*this.height,n=.3*this.width;(new f).moveTo(a,b+h).lineTo(a-n,b+h).toPath(e).attr("stroke-width",this.lightStrokeWidth);var p="?"==this.model.inputs[0]?"black":"0"==this.model.inputs[0]?"#a00":"#0a0";e.circle(a-n,b+h,7.5).attr("fill","white").attr("stroke",p);this.labels[0]=e.text(a-n,b+h,this.model.inputs[0]).attr("stroke",p);(new f).moveTo(a,b+this.height-h).lineTo(a-n,b+this.height-h).toPath(e).attr("stroke-width",this.lightStrokeWidth);
p="?"==this.model.inputs[1]?"black":"0"==this.model.inputs[1]?"#a00":"#0a0";e.circle(a-n,b+this.height-h,7.5).attr("fill","white").attr("stroke",p);this.labels[1]=e.text(a-n,b+this.height-h,this.model.inputs[1]).attr("stroke",p);this.outputWire={x:c+n,y:g};(new f).moveTo(c+d,g).lineTo(c+n,g).toPath(e).attr("stroke-width",this.lightStrokeWidth);null!=this.model.output&&(p="?"==this.model.output?"black":"0"==this.model.output?"#a00":"#0a0",e.circle(c+n,g,7.5).attr("fill","white").attr("stroke",p),this.labels[2]=
e.text(c+n,g,this.model.output).attr("stroke",p))};d.prototype.inputs=function(a){this.inputs=a};d.prototype.evaluate=function(){if(2>this.inputs.length)throw"inputs";var a=[];this.inputs.map(function(b){a.push(b.evaluate())});return this.logic(a)};l.prototype.evaluate=function(){return this.value};window.addEventListener("load",function(){function a(){0>q?q=0:3<q&&(q=3);document.getElementById("time").textContent="t = "+q;var d=new c(["?","?"],null),r=new c(["?","?"],null),l=new c(["?","?"],"?"),
k=new c(["?","?"],null),u=new c(["?","?"],null),t=new c(["?","?"],null);0<=q&&(r=new c([A.inputs[0].evaluate()?"1":"0",A.inputs[1].evaluate()?"1":"0"],null),k=new c([y.inputs[0].evaluate()?"1":"0",y.inputs[1].evaluate()?"1":"0"],null),t=new c([B.inputs[0].evaluate()?"1":"0",B.inputs[1].evaluate()?"1":"0"],null));1<=q&&(d=new c([p.inputs[0].evaluate()?"1":"0",p.inputs[1].evaluate()?"1":"0"],null),u=new c([C.inputs[0].evaluate()?"1":"0",C.inputs[1].evaluate()?"1":"0"],null));2<=q&&(l=new c([w.inputs[0].evaluate()?
"1":"0",w.inputs[1].evaluate()?"1":"0"],"?"));3<=q&&(l=new c([w.inputs[0].evaluate()?"1":"0",w.inputs[1].evaluate()?"1":"0"],w.evaluate()?"1":"0"));b.clear();var d=new v(d,60,40,2,1.25),r=new v(r,60,40,2,1.25),l=new v(l,60,40,2,1.25),k=new v(k,60,40,2,1.25),u=new v(u,60,40,2,1.25),t=new v(t,60,40,2,1.25),m=b.width/2-d.width/2,x=(b.height-50)/2-d.height/2;t.render(m-90,x+12+80,b);(new f).moveTo(t.outputWire.x,t.outputWire.y).lineTo(t.outputWire.x,t.outputWire.y-20).toPath(b);r.render(m-90,x-12-15,
b);k.render(m-90,x+12+20,b);(new f).moveTo(r.outputWire.x,r.outputWire.y).lineTo(r.outputWire.x,r.outputWire.y+15).toPath(b);(new f).moveTo(k.outputWire.x,k.outputWire.y).lineTo(k.outputWire.x,k.outputWire.y-15).toPath(b);(new f).moveTo(k.outputWire.x,k.outputWire.y).lineTo(k.outputWire.x,k.outputWire.y+15).toPath(b);d.render(m,x,b);(new f).moveTo(d.outputWire.x,d.outputWire.y).lineTo(d.outputWire.x,d.outputWire.y+15).toPath(b);u.render(m,x+12+50,b);(new f).moveTo(u.outputWire.x,u.outputWire.y).lineTo(u.outputWire.x,
u.outputWire.y-10).toPath(b);l.render(m+90,x+32,b);r.labels[0].click(function(){e.value="0"==this.attr("text");a()});r.labels[1].click(function(){z.value="0"==this.attr("text");a()});k.labels[0].click(function(){D.value="0"==this.attr("text");a()});k.labels[1].click(function(){g.value="0"==this.attr("text");a()});u.labels[0].click(function(){h.value="0"==this.attr("text");a()});t.labels[0].click(function(){h.value="0"==this.attr("text");a()});t.labels[1].click(function(){n.value="0"==this.attr("text");
a()})}var b=new Raphael(0,50,window.innerWidth,window.innerHeight-50),e=new l(!0),z=new l(!0),D=new l(!0),g=new l(!0),h=new l(!0),n=new l(!0),p=new d(m),A=new d(m),w=new d(m),y=new d(m),C=new d(m),B=new d(m);p.inputs=[A,y];A.inputs=[e,z];w.inputs=[p,C];y.inputs=[D,g];C.inputs=[y,B];B.inputs=[h,n];var q=0;a();document.getElementById("forward").addEventListener("click",function(){q++;a()},!1);document.getElementById("backward").addEventListener("click",function(){q--;a()},!1)})})();
