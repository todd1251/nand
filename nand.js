(function(){function e(){this.commands=[]}function w(a,b,c,f,d){this.model=a;this.width=b;this.height=c;this.heavyStrokeWidth=f;this.lightStrokeWidth=d;this.labels=[]}function h(a){this.logic=a;this.inputs=[]}function k(a){this.value=a}function g(a,b){this.inputs=a;this.output=b}function n(a){return!a.reduce(function(a,c){return a&&c})}e.prototype.moveTo=function(a,b){this.commands.push("M"+a+","+b);return this};e.prototype.lineTo=function(a,b){this.commands.push("L"+a+","+b);return this};e.prototype.arc=
function(a,b,c,f,d,e,l){this.commands.push("A"+a+","+b+" "+c+" "+f+" "+d+" "+e+","+l);return this};e.prototype.close=function(){this.commands.push("Z");return this};e.prototype.toPath=function(a){return a.path(this.commands.join(" "))};w.prototype.render=function(a,b,c){var f=this.width/2,d="?"==this.model.inputs[0];(new e).moveTo(a,b).lineTo(a+f,b).arc(1,1,0,0,1,a+f,b+this.height).lineTo(a,b+this.height).close().toPath(c).attr({"stroke-width":this.heavyStrokeWidth*(d?.5:1),"stroke-dasharray":d?"-":
""});var g=.05*this.width,l=this.height/2,f=a+f+l+g+this.heavyStrokeWidth/2,l=b+l;c.circle(f,l,g).attr({"stroke-width":this.lightStrokeWidth*(d?.5:1),"stroke-dasharray":d?"-":""});var d=.2*this.height,p=.3*this.width;(new e).moveTo(a,b+d).lineTo(a-p,b+d).toPath(c).attr("stroke-width",this.lightStrokeWidth);var q="?"==this.model.inputs[0]?"black":"0"==this.model.inputs[0]?"#a00":"#0a0";c.circle(a-p,b+d,7.5).attr("fill","white").attr("stroke",q);this.labels[0]=c.text(a-p,b+d,this.model.inputs[0]).attr("stroke",
q);this.labels[0].node.setAttribute("class","input");(new e).moveTo(a,b+this.height-d).lineTo(a-p,b+this.height-d).toPath(c).attr("stroke-width",this.lightStrokeWidth);q="?"==this.model.inputs[1]?"black":"0"==this.model.inputs[1]?"#a00":"#0a0";c.circle(a-p,b+this.height-d,7.5).attr("fill","white").attr("stroke",q);this.labels[1]=c.text(a-p,b+this.height-d,this.model.inputs[1]).attr("stroke",q);this.labels[1].node.setAttribute("class","input");this.outputWire={x:f+p,y:l};(new e).moveTo(f+g,l).lineTo(f+
p,l).toPath(c).attr("stroke-width",this.lightStrokeWidth);null!=this.model.output&&(q="?"==this.model.output?"black":"0"==this.model.output?"#a00":"#0a0",c.circle(f+p,l,7.5).attr("fill","white").attr("stroke",q),this.labels[2]=c.text(f+p,l,this.model.output).attr("stroke",q),this.labels[2].node.setAttribute("class","output"))};h.prototype.inputs=function(a){this.inputs=a};h.prototype.evaluate=function(){if(2>this.inputs.length)throw"inputs";var a=[];this.inputs.map(function(b){a.push(b.evaluate())});
return this.logic(a)};k.prototype.evaluate=function(){return this.value};window.addEventListener("load",function(){function a(){0>r?r=0:3<r&&(r=3);document.getElementById("time").textContent="t = "+r;var c=new g(["?","?"],null),t=new g(["?","?"],null),h=new g(["?","?"],"?"),m=new g(["?","?"],null),u=new g(["?","?"],null),v=new g(["?","?"],null);0<=r&&(t=new g([z.inputs[0].evaluate()?"1":"0",z.inputs[1].evaluate()?"1":"0"],null),m=new g([y.inputs[0].evaluate()?"1":"0",y.inputs[1].evaluate()?"1":"0"],
null),v=new g([A.inputs[0].evaluate()?"1":"0",A.inputs[1].evaluate()?"1":"0"],null));1<=r&&(c=new g([B.inputs[0].evaluate()?"1":"0",B.inputs[1].evaluate()?"1":"0"],null),u=new g([C.inputs[0].evaluate()?"1":"0",C.inputs[1].evaluate()?"1":"0"],null));2<=r&&(h=new g([x.inputs[0].evaluate()?"1":"0",x.inputs[1].evaluate()?"1":"0"],"?"));3<=r&&(h=new g([x.inputs[0].evaluate()?"1":"0",x.inputs[1].evaluate()?"1":"0"],x.evaluate()?"1":"0"));b.clear();var c=new w(c,60,40,2,1.25),t=new w(t,60,40,2,1.25),h=new w(h,
60,40,2,1.25),m=new w(m,60,40,2,1.25),u=new w(u,60,40,2,1.25),v=new w(v,60,40,2,1.25),k=b.width/2-c.width/2,n=b.height/2-c.height/2;v.render(k-90,n+12+80,b);(new e).moveTo(v.outputWire.x,v.outputWire.y).lineTo(v.outputWire.x,v.outputWire.y-20).toPath(b);t.render(k-90,n-12-15,b);m.render(k-90,n+12+20,b);(new e).moveTo(t.outputWire.x,t.outputWire.y).lineTo(t.outputWire.x,t.outputWire.y+15).toPath(b);(new e).moveTo(m.outputWire.x,m.outputWire.y).lineTo(m.outputWire.x,m.outputWire.y-15).toPath(b);(new e).moveTo(m.outputWire.x,
m.outputWire.y).lineTo(m.outputWire.x,m.outputWire.y+15).toPath(b);c.render(k,n,b);(new e).moveTo(c.outputWire.x,c.outputWire.y).lineTo(c.outputWire.x,c.outputWire.y+15).toPath(b);u.render(k,n+12+50,b);(new e).moveTo(u.outputWire.x,u.outputWire.y).lineTo(u.outputWire.x,u.outputWire.y-10).toPath(b);h.render(k+90,n+32,b);c.labels[0].node.setAttribute("class","output");c.labels[1].node.setAttribute("class","output");h.labels[0].node.setAttribute("class","output");h.labels[1].node.setAttribute("class",
"output");u.labels[0].node.setAttribute("class","output");u.labels[1].node.setAttribute("class","output");t.labels[0].click(function(){f.value="0"==this.attr("text");a()});t.labels[1].click(function(){d.value="0"==this.attr("text");a()});m.labels[0].click(function(){D.value="0"==this.attr("text");a()});m.labels[1].click(function(){l.value="0"==this.attr("text");a()});v.labels[0].click(function(){p.value="0"==this.attr("text");a()});v.labels[1].click(function(){q.value="0"==this.attr("text");a()})}
var b=new Raphael(0,0,window.innerWidth,window.innerHeight),c=document.getElementById("controls");c.style.left=b.width/2-c.clientWidth/2+"px";c.style.top=b.height/2-c.clientHeight/2-80+"px";var f=new k(!0),d=new k(!0),D=new k(!0),l=new k(!0),p=new k(!0),q=new k(!0),B=new h(n),z=new h(n),x=new h(n),y=new h(n),C=new h(n),A=new h(n);B.inputs=[z,y];z.inputs=[f,d];x.inputs=[B,C];y.inputs=[D,l];C.inputs=[y,A];A.inputs=[p,q];var r=0;a();document.getElementById("forward").addEventListener("click",function(){r++;
a()},!1);document.getElementById("backward").addEventListener("click",function(){r--;a()},!1)})})();
