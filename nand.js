(function(){function e(){this.commands=[]}function u(a,b,c,d,e){this.model=a;this.width=b;this.height=c;this.heavyStrokeWidth=d;this.lightStrokeWidth=e;this.labels=[]}function g(a){this.logic=a;this.inputs=[]}function k(a){this.value=a}function f(a,b){this.inputs=a;this.output=b}function n(a){return!a.reduce(function(a,c){return a&&c})}e.prototype.moveTo=function(a,b){this.commands.push("M"+a+","+b);return this};e.prototype.lineTo=function(a,b){this.commands.push("L"+a+","+b);return this};e.prototype.arc=
function(a,b,c,d,e,h,l){this.commands.push("A"+a+","+b+" "+c+" "+d+" "+e+" "+h+","+l);return this};e.prototype.close=function(){this.commands.push("Z");return this};e.prototype.toPath=function(a){return a.path(this.commands.join(" "))};u.prototype.render=function(a,b,c){var d=this.width/2;(new e).moveTo(a,b).lineTo(a+d,b).arc(1,1,0,0,1,a+d,b+this.height).lineTo(a,b+this.height).close().toPath(c).attr("stroke-width",this.heavyStrokeWidth);var f=.05*this.width,h=this.height/2,d=a+d+h+f+this.heavyStrokeWidth/
2,h=b+h;c.circle(d,h,f).attr("stroke-width",this.lightStrokeWidth);var l=.2*this.height,m=.3*this.width;(new e).moveTo(a,b+l).lineTo(a-m,b+l).toPath(c).attr("stroke-width",this.lightStrokeWidth);c.circle(a-m,b+l,7.5).attr("fill","white");this.labels[0]=c.text(a-m,b+l,this.model.inputs[0]);(new e).moveTo(a,b+this.height-l).lineTo(a-m,b+this.height-l).toPath(c).attr("stroke-width",this.lightStrokeWidth);c.circle(a-m,b+this.height-l,7.5).attr("fill","white");this.labels[1]=c.text(a-m,b+this.height-l,
this.model.inputs[1]);this.outputWire={x:d+m,y:h};(new e).moveTo(d+f,h).lineTo(d+m,h).toPath(c).attr("stroke-width",this.lightStrokeWidth);null!=this.model.output&&(c.circle(d+m,h,7.5).attr("fill","white"),this.labels[2]=c.text(d+m,h,this.model.output))};g.prototype.inputs=function(a){this.inputs=a};g.prototype.evaluate=function(){if(2>this.inputs.length)throw"inputs";var a=[];this.inputs.map(function(b){a.push(b.evaluate())});return this.logic(a)};k.prototype.evaluate=function(){return this.value};
window.addEventListener("load",function(){function a(){0>p?p=0:3<p&&(p=3);document.getElementById("time").textContent="t = "+p;var g=new f(["?","?"],null),q=new f(["?","?"],null),k=new f(["?","?"],"?"),r=new f(["?","?"],null),t=new f(["?","?"],null);0<=p&&(q=new f([x.inputs[0].evaluate()?"1":"0",x.inputs[1].evaluate()?"1":"0"],null),r=new f([y.inputs[0].evaluate()?"1":"0",y.inputs[1].evaluate()?"1":"0"],null));1<=p&&(g=new f([z.inputs[0].evaluate()?"1":"0",z.inputs[1].evaluate()?"1":"0"],null),t=
new f([A.inputs[0].evaluate()?"1":"0",A.inputs[1].evaluate()?"1":"0"],null));2<=p&&(k=new f([v.inputs[0].evaluate()?"1":"0",v.inputs[1].evaluate()?"1":"0"],"?"));3<=p&&(k=new f([v.inputs[0].evaluate()?"1":"0",v.inputs[1].evaluate()?"1":"0"],v.evaluate()?"1":"0"));b.clear();var g=new u(g,60,40,2,1.25),q=new u(q,60,40,2,1.25),k=new u(k,60,40,2,1.25),r=new u(r,60,40,2,1.25),t=new u(t,60,40,2,1.25),n=b.width/2-g.width/2,w=(b.height-50)/2-g.height/2;q.render(n-90,w-12-15,b);r.render(n-90,w+12+15,b);(new e).moveTo(q.outputWire.x,
q.outputWire.y).lineTo(q.outputWire.x,q.outputWire.y+15).toPath(b);(new e).moveTo(r.outputWire.x,r.outputWire.y).lineTo(r.outputWire.x,r.outputWire.y-15).toPath(b);g.render(n,w,b);t.render(n,w+12+50,b);(new e).moveTo(t.outputWire.x,t.outputWire.y).lineTo(t.outputWire.x,t.outputWire.y-30).toPath(b);k.render(n+90,w+12,b);q.labels[0].click(function(){c.value="0"==this.attr("text");a()});q.labels[1].click(function(){d.value="0"==this.attr("text");a()});r.labels[0].click(function(){B.value="0"==this.attr("text");
a()});r.labels[1].click(function(){h.value="0"==this.attr("text");a()});t.labels[0].click(function(){l.value="0"==this.attr("text");a()});t.labels[1].click(function(){m.value="0"==this.attr("text");a()})}var b=new Raphael(0,50,window.innerWidth,window.innerHeight-50),c=new k(!0),d=new k(!0),B=new k(!0),h=new k(!0),l=new k(!0),m=new k(!0),z=new g(n),x=new g(n),v=new g(n),y=new g(n),A=new g(n);z.inputs=[x,y];x.inputs=[c,d];v.inputs=[z,A];y.inputs=[B,h];A.inputs=[l,m];var p=0;a();document.getElementById("forward").addEventListener("click",
function(){p++;a()},!1);document.getElementById("backward").addEventListener("click",function(){p--;a()},!1)})})();
