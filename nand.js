(function(){function e(){this.commands=[]}function x(a,b,c,f,d){this.model=a;this.width=b;this.height=c;this.heavyStrokeWidth=f;this.lightStrokeWidth=d;this.labels=[]}function h(a){this.logic=a;this.inputs=[]}function k(a){this.value=a}function g(a,b){this.inputs=a;this.output=b}function n(a){return!a.reduce(function(a,c){return a&&c})}e.prototype.moveTo=function(a,b){this.commands.push("M"+a+","+b);return this};e.prototype.lineTo=function(a,b){this.commands.push("L"+a+","+b);return this};e.prototype.arc=
function(a,b,c,f,d,e,l){this.commands.push("A"+a+","+b+" "+c+" "+f+" "+d+" "+e+","+l);return this};e.prototype.close=function(){this.commands.push("Z");return this};e.prototype.toPath=function(a){return a.path(this.commands.join(" "))};x.prototype.render=function(a,b,c){var f=this.width/2,d="?"==this.model.inputs[0];(new e).moveTo(a,b).lineTo(a+f,b).arc(1,1,0,0,1,a+f,b+this.height).lineTo(a,b+this.height).close().toPath(c).attr({"stroke-width":this.heavyStrokeWidth*(d?.5:1),"stroke-dasharray":d?"-":
""});var g=.05*this.width,l=this.height/2,f=a+f+l+g+this.heavyStrokeWidth/2,l=b+l;c.circle(f,l,g).attr({"stroke-width":this.lightStrokeWidth*(d?.5:1),"stroke-dasharray":d?"-":""});var d=.2*this.height,p=.3*this.width;(new e).moveTo(a,b+d).lineTo(a-p,b+d).toPath(c).attr("stroke-width",this.lightStrokeWidth);var q="?"==this.model.inputs[0]?"black":"0"==this.model.inputs[0]?"#a00":"#0a0";c.circle(a-p,b+d,7.5).attr("fill","white").attr("stroke",q);this.labels[0]=c.text(a-p,b+d,this.model.inputs[0]).attr("stroke",
q);this.labels[0].node.setAttribute("class","input");(new e).moveTo(a,b+this.height-d).lineTo(a-p,b+this.height-d).toPath(c).attr("stroke-width",this.lightStrokeWidth);q="?"==this.model.inputs[1]?"black":"0"==this.model.inputs[1]?"#a00":"#0a0";c.circle(a-p,b+this.height-d,7.5).attr("fill","white").attr("stroke",q);this.labels[1]=c.text(a-p,b+this.height-d,this.model.inputs[1]).attr("stroke",q);this.labels[1].node.setAttribute("class","input");this.outputWire={x:f+p,y:l};(new e).moveTo(f+g,l).lineTo(f+
p,l).toPath(c).attr("stroke-width",this.lightStrokeWidth);null!=this.model.output&&(q="?"==this.model.output?"black":"0"==this.model.output?"#a00":"#0a0",c.circle(f+p,l,7.5).attr("fill","white").attr("stroke",q),this.labels[2]=c.text(f+p,l,this.model.output).attr("stroke",q),this.labels[2].node.setAttribute("class","output"))};h.prototype.inputs=function(a){this.inputs=a};h.prototype.evaluate=function(){if(2>this.inputs.length)throw"inputs";var a=[];this.inputs.map(function(b){a.push(b.evaluate())});
return this.logic(a)};k.prototype.evaluate=function(){return this.value};window.addEventListener("load",function(){function a(){0>t?t=0:3<t&&(t=3);document.getElementById("time").textContent="t = "+t;var r=new g(["?","?"],null),u=new g(["?","?"],null),h=new g(["?","?"],"?"),m=new g(["?","?"],null),v=new g(["?","?"],null),w=new g(["?","?"],null);0<=t&&(u=new g([A.inputs[0].evaluate()?"1":"0",A.inputs[1].evaluate()?"1":"0"],null),m=new g([z.inputs[0].evaluate()?"1":"0",z.inputs[1].evaluate()?"1":"0"],
null),w=new g([B.inputs[0].evaluate()?"1":"0",B.inputs[1].evaluate()?"1":"0"],null));1<=t&&(r=new g([q.inputs[0].evaluate()?"1":"0",q.inputs[1].evaluate()?"1":"0"],null),v=new g([C.inputs[0].evaluate()?"1":"0",C.inputs[1].evaluate()?"1":"0"],null));2<=t&&(h=new g([y.inputs[0].evaluate()?"1":"0",y.inputs[1].evaluate()?"1":"0"],"?"));3<=t&&(h=new g([y.inputs[0].evaluate()?"1":"0",y.inputs[1].evaluate()?"1":"0"],y.evaluate()?"1":"0"));b.clear();var r=new x(r,60,40,2,1.25),u=new x(u,60,40,2,1.25),h=new x(h,
60,40,2,1.25),m=new x(m,60,40,2,1.25),v=new x(v,60,40,2,1.25),w=new x(w,60,40,2,1.25),k=b.width/2-r.width/2,n=(b.height-50)/2-r.height/2;w.render(k-90,n+12+80,b);(new e).moveTo(w.outputWire.x,w.outputWire.y).lineTo(w.outputWire.x,w.outputWire.y-20).toPath(b);u.render(k-90,n-12-15,b);m.render(k-90,n+12+20,b);(new e).moveTo(u.outputWire.x,u.outputWire.y).lineTo(u.outputWire.x,u.outputWire.y+15).toPath(b);(new e).moveTo(m.outputWire.x,m.outputWire.y).lineTo(m.outputWire.x,m.outputWire.y-15).toPath(b);
(new e).moveTo(m.outputWire.x,m.outputWire.y).lineTo(m.outputWire.x,m.outputWire.y+15).toPath(b);r.render(k,n,b);(new e).moveTo(r.outputWire.x,r.outputWire.y).lineTo(r.outputWire.x,r.outputWire.y+15).toPath(b);v.render(k,n+12+50,b);(new e).moveTo(v.outputWire.x,v.outputWire.y).lineTo(v.outputWire.x,v.outputWire.y-10).toPath(b);h.render(k+90,n+32,b);r.labels[0].node.setAttribute("class","output");r.labels[1].node.setAttribute("class","output");h.labels[0].node.setAttribute("class","output");h.labels[1].node.setAttribute("class",
"output");v.labels[0].node.setAttribute("class","output");v.labels[1].node.setAttribute("class","output");u.labels[0].click(function(){c.value="0"==this.attr("text");a()});u.labels[1].click(function(){f.value="0"==this.attr("text");a()});m.labels[0].click(function(){d.value="0"==this.attr("text");a()});m.labels[1].click(function(){D.value="0"==this.attr("text");a()});w.labels[0].click(function(){l.value="0"==this.attr("text");a()});w.labels[1].click(function(){p.value="0"==this.attr("text");a()})}
var b=new Raphael(0,50,window.innerWidth,window.innerHeight-50),c=new k(!0),f=new k(!0),d=new k(!0),D=new k(!0),l=new k(!0),p=new k(!0),q=new h(n),A=new h(n),y=new h(n),z=new h(n),C=new h(n),B=new h(n);q.inputs=[A,z];A.inputs=[c,f];y.inputs=[q,C];z.inputs=[d,D];C.inputs=[z,B];B.inputs=[l,p];var t=0;a();document.getElementById("forward").addEventListener("click",function(){t++;a()},!1);document.getElementById("backward").addEventListener("click",function(){t--;a()},!1)})})();
