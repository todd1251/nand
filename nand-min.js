var NAND=function(b){function c(a){this.model=a;this.outlines=[];this.labels=[];this.paths=[]}c.prototype.render=function(a){var t=this.model.heavyStrokeWidth,c=this.model.lightStrokeWidth,d=this.model.width/2,h=this.model.height/2,e=this.model.x-d,f=this.model.y-h,g="?"==this.model.inputs[0];this.paths[0]=(new b.PathBuilder).moveTo(e,f).lineTo(e+d,f).arc(1,1,0,0,1,e+d,f+this.model.height).lineTo(e,f+this.model.height).close().toPath(a).attr({fill:"white","stroke-width":t*(g?.5:1),"stroke-dasharray":g?
"-":""}).drag(b.makeMove(this),b.start,b.up(this));var g=.05*this.model.width,t=e+d+h+g+t/2,h=f+h,d=.2*this.model.height,k=.3*this.model.width;this.paths[2]=(new b.PathBuilder).moveTo(e,f+d).lineTo(e-k,f+d).toPath(a).attr("stroke-width",c);var l="?"==this.model.inputs[0]?"black":"0"==this.model.inputs[0]?"#a00":"#0a0";this.outlines[0]=a.circle(e-k,f+d,7.5).attr("fill","white").attr("stroke",l);this.labels[0]=a.text(e-k,f+d,this.model.inputs[0]).attr("stroke",l);this.labels[0].node.setAttribute("class",
"intermediate");this.paths[3]=(new b.PathBuilder).moveTo(e,f+this.model.height-d).lineTo(e-k,f+this.model.height-d).toPath(a).attr("stroke-width",c);l="?"==this.model.inputs[1]?"black":"0"==this.model.inputs[1]?"#a00":"#0a0";this.outlines[1]=a.circle(e-k,f+this.model.height-d,7.5).attr("fill","white").attr("stroke",l);this.labels[1]=a.text(e-k,f+this.model.height-d,this.model.inputs[1]).attr("stroke",l);this.labels[1].node.setAttribute("class","intermediate");this.outputWire={x:t+k,y:h};this.outlines[3]=
(new b.PathBuilder).moveTo(t+g,h).lineTo(t+k,h).toPath(a).attr("stroke-width",c);null!=this.model.output&&(l="?"==this.model.output?"black":"0"==this.model.output?"#a00":"#0a0",this.outlines[2]=a.circle(t+k,h,7.5).attr("fill","white").attr("stroke",l),this.labels[2]=a.text(t+k,h,this.model.output).attr("stroke",l),this.labels[2].node.setAttribute("class","intermediate"))};c.prototype.update=function(){var a="?"==this.model.inputs[0]?"black":"0"==this.model.inputs[0]?"#a00":"#0a0";this.labels[0].attr("text",
this.model.inputs[0]).attr("stroke",a);this.outlines[0].attr("stroke",a);a="?"==this.model.inputs[1]?"black":"0"==this.model.inputs[1]?"#a00":"#0a0";this.labels[1].attr("text",this.model.inputs[1]).attr("stroke",a);this.outlines[1].attr("stroke",a);a="?"==this.model.output?"black":"0"==this.model.output?"#a00":"#0a0";this.labels[2].attr("text",this.model.output).attr("stroke",a);this.outlines[2].attr("stroke",a);a="?"==this.model.inputs[0];this.paths[0].attr("stroke-dasharray",a?"-":"");this.paths[2].attr("stroke-dasharray",
a?"-":"");this.paths[3].attr("stroke-dasharray",a?"-":"")};b.AndView=c;return b}(NAND||{});NAND=function(b){function c(a){this.id=a;this.kind="delay";this.inputs=[];this.outputs=[]}c.prototype.connect=function(a){this.outputs.push(a);a.inputs.push(this)};c.prototype.traverse=function(a,b,c){a(this,b,c);this.outputs.map(function(d){d.traverse(a,b,c+1)})};c.prototype.evaluate=function(){return this.inputs[0].evaluate()};b.Delay=c;return b}(NAND||{});NAND=function(b){function c(a){this.model=a}c.prototype.render=function(a){};b.DelayView=c;return b}(NAND||{});NAND=function(b){function c(a){this.id=a;this.kind="fanout";this.inputs=[];this.outputs=[]}c.prototype.connect=function(a){this.outputs.push(a);a.inputs.push(this)};c.prototype.traverse=function(a,b,c){a(this,b,c);this.outputs.map(function(d){d.traverse(a,b,c+1)})};c.prototype.evaluate=function(){return this.inputs[0].evaluate()};b.FanOut=c;return b}(NAND||{});NAND=function(b){function c(a){this.model=a}c.prototype.render=function(a){var t=this.model.x,c=this.model.y;(new b.PathBuilder).moveTo(t+42,c).lineTo(t+42,c+10).toPath(a)};b.FanOutView=c;return b}(NAND||{});NAND=function(b){function c(a,b,c){this.id=a;this.kind="gate";this.gate=b;this.logic=c;this.inputs=[];this.outputs=[]}c.prototype.connect=function(a){this.outputs.push(a);a.inputs.push(this)};c.prototype.traverse=function(a,b,c){a(this,b,c);this.outputs.map(function(d){d.traverse(a,b,c+1)})};c.prototype.evaluate=function(){if("not"==this.gate&&1!=this.inputs.length||"not"!=this.gate&&2>this.inputs.length)throw"inputs";var a=[];this.inputs.map(function(b){a.push(b.evaluate())});return this.logic(a)};
b.Gate=c;return b}(NAND||{});NAND=function(b){function c(a){this.model=a;this.outlines=[];this.labels=[];this.paths=[]}c.prototype.render=function(a){var b=this.model.heavyStrokeWidth,c=this.model.lightStrokeWidth,d=this.model.width/2,h=this.model.height/2,e=this.model.x-d,f=this.model.y-h,g="?"==this.model.inputs[0];this.paths[0]=(new PathBuilder).moveTo(e,f).lineTo(e+d,f).arc(1,1,0,0,1,e+d,f+this.model.height).lineTo(e,f+this.model.height).close().toPath(a).attr({fill:"white","stroke-width":b*(g?.5:1),"stroke-dasharray":g?
"-":""});var k=.05*this.model.width,b=e+d+h+k+b/2,h=f+h;a.circle(b,h,k).attr({fill:"white","stroke-width":c*(g?.5:1),"stroke-dasharray":g?"-":""});g=.2*this.model.height;d=.3*this.model.width;this.paths[2]=(new PathBuilder).moveTo(e,f+g).lineTo(e-d,f+g).toPath(a).attr("stroke-width",c);var l="?"==this.model.inputs[0]?"black":"0"==this.model.inputs[0]?"#a00":"#0a0";this.outlines[0]=a.circle(e-d,f+g,7.5).attr("fill","white").attr("stroke",l);this.labels[0]=a.text(e-d,f+g,this.model.inputs[0]).attr("stroke",
l);this.labels[0].node.setAttribute("class","intermediate");this.paths[3]=(new PathBuilder).moveTo(e,f+this.model.height-g).lineTo(e-d,f+this.model.height-g).toPath(a).attr("stroke-width",c);l="?"==this.model.inputs[1]?"black":"0"==this.model.inputs[1]?"#a00":"#0a0";this.outlines[1]=a.circle(e-d,f+this.model.height-g,7.5).attr("fill","white").attr("stroke",l);this.labels[1]=a.text(e-d,f+this.model.height-g,this.model.inputs[1]).attr("stroke",l);this.labels[1].node.setAttribute("class","intermediate");
this.outputWire={x:b+d,y:h};(new PathBuilder).moveTo(b+k,h).lineTo(b+d,h).toPath(a).attr("stroke-width",c);null!=this.model.output&&(l="?"==this.model.output?"black":"0"==this.model.output?"#a00":"#0a0",this.outlines[2]=a.circle(b+d,h,7.5).attr("fill","white").attr("stroke",l),this.labels[2]=a.text(b+d,h,this.model.output).attr("stroke",l),this.labels[2].node.setAttribute("class","intermediate"))};c.prototype.update=function(){var a="?"==this.model.inputs[0]?"black":"0"==this.model.inputs[0]?"#a00":
"#0a0";this.labels[0].attr("text",this.model.inputs[0]).attr("stroke",a);this.outlines[0].attr("stroke",a);a="?"==this.model.inputs[1]?"black":"0"==this.model.inputs[1]?"#a00":"#0a0";this.labels[1].attr("text",this.model.inputs[1]).attr("stroke",a);this.outlines[1].attr("stroke",a);a="?"==this.model.output?"black":"0"==this.model.output?"#a00":"#0a0";this.labels[2].attr("text",this.model.output).attr("stroke",a);this.outlines[2].attr("stroke",a);a="?"==this.model.inputs[0];this.paths[0].attr("stroke-dasharray",
a?"-":"");this.paths[2].attr("stroke-dasharray",a?"-":"");this.paths[3].attr("stroke-dasharray",a?"-":"")};b.NandView=c;return b}(NAND||{});NAND=function(b){function c(a){this.model=a;this.outlines=[];this.labels=[];this.paths=[]}c.prototype.render=function(a){var c=this.model.heavyStrokeWidth,m=this.model.lightStrokeWidth,d=this.model.width/2,h=this.model.height/2,e=this.model.x-d,f=this.model.y-h,g="?"==this.model.inputs[0],k=.4*this.model.width,l=2*this.model.width/3,r=.15*this.model.width;this.paths[0]=(new b.PathBuilder).moveTo(e,f).lineTo(e+k,f).arc(l,l,0,0,1,e+this.model.width-r,f+h).arc(l,l,0,0,1,e+k,f+this.model.height).lineTo(e,
f+this.model.height).toPath(a).attr({fill:"white","stroke-width":c*(g?.5:1),"stroke-dasharray":g?"-":""});this.paths[1]=(new b.PathBuilder).moveTo(e,f).arc(k,k,0,0,1,e,f+this.model.height).toPath(a).attr({fill:"white","stroke-width":c*(g?.5:1),"stroke-dasharray":g?"-":""});k=.05*this.model.width;c=e+d+h+k+c/2;h=f+h;a.circle(c,h,k).attr({fill:"white","stroke-width":m*(g?.5:1),"stroke-dasharray":g?"-":""});g=.2*this.model.height;d=.3*this.model.width;this.paths[2]=(new b.PathBuilder).moveTo(e+d-1-.5*
d,f+g).lineTo(e-d,f+g).toPath(a).attr("stroke-width",m);l="?"==this.model.inputs[0]?"black":"0"==this.model.inputs[0]?"#a00":"#0a0";this.outlines[0]=a.circle(e-d,f+g,7.5).attr("fill","white").attr("stroke",l);this.labels[0]=a.text(e-d,f+g,this.model.inputs[0]).attr("stroke",l);this.labels[0].node.setAttribute("class","intermediate");this.paths[3]=(new b.PathBuilder).moveTo(e+d-1-.5*d,f+this.model.height-g).lineTo(e-d,f+this.model.height-g).toPath(a).attr("stroke-width",m);l="?"==this.model.inputs[1]?
"black":"0"==this.model.inputs[1]?"#a00":"#0a0";this.outlines[1]=a.circle(e-d,f+this.model.height-g,7.5).attr("fill","white").attr("stroke",l);this.labels[1]=a.text(e-d,f+this.model.height-g,this.model.inputs[1]).attr("stroke",l);this.labels[1].node.setAttribute("class","intermediate");this.outputWire={x:c+d,y:h};(new b.PathBuilder).moveTo(c+k,h).lineTo(c+d,h).toPath(a).attr("stroke-width",m);null!=this.model.output&&(l="?"==this.model.output?"black":"0"==this.model.output?"#a00":"#0a0",this.outlines[2]=
a.circle(c+d,h,7.5).attr("fill","white").attr("stroke",l),this.labels[2]=a.text(c+d,h,this.model.output).attr("stroke",l),this.labels[2].node.setAttribute("class","intermediate"))};c.prototype.update=function(){var a="?"==this.model.inputs[0]?"black":"0"==this.model.inputs[0]?"#a00":"#0a0";this.labels[0].attr("text",this.model.inputs[0]).attr("stroke",a);this.outlines[0].attr("stroke",a);a="?"==this.model.inputs[1]?"black":"0"==this.model.inputs[1]?"#a00":"#0a0";this.labels[1].attr("text",this.model.inputs[1]).attr("stroke",
a);this.outlines[1].attr("stroke",a);a="?"==this.model.output?"black":"0"==this.model.output?"#a00":"#0a0";this.labels[2].attr("text",this.model.output).attr("stroke",a);this.outlines[2].attr("stroke",a);a="?"==this.model.inputs[0];this.paths[0].attr("stroke-dasharray",a?"-":"");this.paths[1].attr("stroke-dasharray",a?"-":"");this.paths[2].attr("stroke-dasharray",a?"-":"");this.paths[3].attr("stroke-dasharray",a?"-":"")};b.NorView=c;return b}(NAND||{});NAND=function(b){function c(a){this.model=a;this.outlines=[];this.labels=[];this.paths=[]}c.prototype.render=function(a){var c=this.model.heavyStrokeWidth,m=this.model.lightStrokeWidth,d=this.model.width/2,h=this.model.height/2,e=this.model.x-d,f=this.model.y-h,g="?"==this.model.inputs[0];this.paths[0]=(new b.PathBuilder).moveTo(e,f).lineTo(e+this.model.width-20,f+h).lineTo(e,f+this.model.height).close().toPath(a).attr({fill:"white","stroke-width":c*(g?.5:1),"stroke-dasharray":g?"-":""});var k=.05*
this.model.width,c=e+d+h+k+c/2-11,d=f+h;a.circle(c,d,k).attr({fill:"white","stroke-width":m*(g?.5:1),"stroke-dasharray":g?"-":""});g=.3*this.model.width;this.paths[1]=(new b.PathBuilder).moveTo(e,f+h).lineTo(e-g,f+h).toPath(a).attr("stroke-width",m);var l="?"==this.model.inputs[0]?"black":"0"==this.model.inputs[0]?"#a00":"#0a0";this.outlines[0]=a.circle(e-g,f+h,7.5).attr("fill","white").attr("stroke",l);this.labels[0]=a.text(e-g,f+h,this.model.inputs[0]).attr("stroke",l);this.labels[0].node.setAttribute("class",
"intermediate");this.outputWire={x:c+g,y:d};(new b.PathBuilder).moveTo(c+k,d).lineTo(c+g,d).toPath(a).attr("stroke-width",m);null!=this.model.output&&(l="?"==this.model.output?"black":"0"==this.model.output?"#a00":"#0a0",this.outlines[1]=a.circle(c+g,d,7.5).attr("fill","white").attr("stroke",l),this.labels[1]=a.text(c+g,d,this.model.output).attr("stroke",l),this.labels[1].node.setAttribute("class","intermediate"))};c.prototype.update=function(){var a="?"==this.model.inputs[0]?"black":"0"==this.model.inputs[0]?
"#a00":"#0a0";this.labels[0].attr("text",this.model.inputs[0]).attr("stroke",a);this.outlines[0].attr("stroke",a);a="?"==this.model.output?"black":"0"==this.model.output?"#a00":"#0a0";this.labels[1].attr("text",this.model.output).attr("stroke",a);this.outlines[1].attr("stroke",a);a="?"==this.model.inputs[0];this.paths[0].attr("stroke-dasharray",a?"-":"");this.paths[1].attr("stroke-dasharray",a?"-":"")};b.NotView=c;return b}(NAND||{});NAND=function(b){function c(a){this.model=a;this.outlines=[];this.labels=[];this.paths=[]}c.prototype.render=function(a){var c=this.model.heavyStrokeWidth,m=this.model.lightStrokeWidth,d=this.model.width/2,h=this.model.height/2,e=this.model.x-d,f=this.model.y-h,g="?"==this.model.inputs[0],k=.4*this.model.width,l=2*this.model.width/3,r=.15*this.model.width;this.paths[0]=(new b.PathBuilder).moveTo(e,f).lineTo(e+k,f).arc(l,l,0,0,1,e+this.model.width-r,f+h).arc(l,l,0,0,1,e+k,f+this.model.height).lineTo(e,
f+this.model.height).toPath(a).attr({fill:"white","stroke-width":c*(g?.5:1),"stroke-dasharray":g?"-":""}).drag(b.makeMove(this),b.start,b.up(this));this.paths[1]=(new b.PathBuilder).moveTo(e,f).arc(k,k,0,0,1,e,f+this.model.height).toPath(a).attr({fill:"white","stroke-width":c*(g?.5:1),"stroke-dasharray":g?"-":""});g=.05*this.model.width;c=e+d+h+g+c/2;h=f+h;d=.2*this.model.height;k=.3*this.model.width;this.paths[2]=(new b.PathBuilder).moveTo(e+k-1-.5*k,f+d).lineTo(e-k,f+d).toPath(a).attr("stroke-width",
m);l="?"==this.model.inputs[0]?"black":"0"==this.model.inputs[0]?"#a00":"#0a0";this.outlines[0]=a.circle(e-k,f+d,7.5).attr("fill","white").attr("stroke",l);this.labels[0]=a.text(e-k,f+d,this.model.inputs[0]).attr("stroke",l);this.labels[0].node.setAttribute("class","intermediate");this.paths[3]=(new b.PathBuilder).moveTo(e+k-1-.5*k,f+this.model.height-d).lineTo(e-k,f+this.model.height-d).toPath(a).attr("stroke-width",m);l="?"==this.model.inputs[1]?"black":"0"==this.model.inputs[1]?"#a00":"#0a0";this.outlines[1]=
a.circle(e-k,f+this.model.height-d,7.5).attr("fill","white").attr("stroke",l);this.labels[1]=a.text(e-k,f+this.model.height-d,this.model.inputs[1]).attr("stroke",l);this.labels[1].node.setAttribute("class","intermediate");this.outputWire={x:c+k,y:h};this.outlines[3]=(new b.PathBuilder).moveTo(c+g,h).lineTo(c+k,h).toPath(a).attr("stroke-width",m);null!=this.model.output&&(l="?"==this.model.output?"black":"0"==this.model.output?"#a00":"#0a0",this.outlines[2]=a.circle(c+k,h,7.5).attr("fill","white").attr("stroke",
l),this.labels[2]=a.text(c+k,h,this.model.output).attr("stroke",l),this.labels[2].node.setAttribute("class","intermediate"))};c.prototype.update=function(){var a="?"==this.model.inputs[0]?"black":"0"==this.model.inputs[0]?"#a00":"#0a0";this.labels[0].attr("text",this.model.inputs[0]).attr("stroke",a);this.outlines[0].attr("stroke",a);a="?"==this.model.inputs[1]?"black":"0"==this.model.inputs[1]?"#a00":"#0a0";this.labels[1].attr("text",this.model.inputs[1]).attr("stroke",a);this.outlines[1].attr("stroke",
a);a="?"==this.model.output?"black":"0"==this.model.output?"#a00":"#0a0";this.labels[2].attr("text",this.model.output).attr("stroke",a);this.outlines[2].attr("stroke",a);a="?"==this.model.inputs[0];this.paths[0].attr("stroke-dasharray",a?"-":"");this.paths[1].attr("stroke-dasharray",a?"-":"");this.paths[2].attr("stroke-dasharray",a?"-":"");this.paths[3].attr("stroke-dasharray",a?"-":"")};b.OrView=c;return b}(NAND||{});NAND=function(b){function c(){this.commands=[]}c.prototype.moveTo=function(a,b){this.commands.push("M"+a+","+b);return this};c.prototype.lineTo=function(a,b){this.commands.push("L"+a+","+b);return this};c.prototype.arc=function(a,b,c,d,h,e,f){this.commands.push("A"+a+","+b+" "+c+" "+d+" "+h+" "+e+","+f);return this};c.prototype.close=function(){this.commands.push("Z");return this};c.prototype.toPath=function(a){return a.path(this.commands.join(" "))};b.PathBuilder=c;return b}(NAND||{});NAND=function(b){function c(a){this.id=a;this.kind="sink";this.inputs=[]}c.prototype.connect=function(a){this.inputs.push(a);a.outputs.push(this)};c.prototype.traverse=function(a,b,c){a(this,b,c)};c.prototype.evaluate=function(){return this.inputs[0].evaluate()};b.Sink=c;return b}(NAND||{});NAND=function(b){function c(a){this.model=a;this.paths=[];this.outlines=[];this.labels=[]}c.prototype.render=function(a){var c=this.model.value,m=this.model.x,d=this.model.y,h="?"==c?"black":"0"==c?"#a00":"#0a0";this.outlines[0]=a.rect(m-7,d-7,14,14).attr("stroke",h).attr("fill","white").drag(b.makeMove(this),b.start,b.up(this));this.labels[0]=a.text(m,d,c).attr("stroke",h).drag(b.makeMove(this),b.start,b.up(this));this.labels[0].node.setAttribute("class","output")};c.prototype.update=function(){var a=
this.model.value,b="?"==a?"black":"0"==a?"#a00":"#0a0";this.labels[0].attr("text",a).attr("stroke",b);this.outlines[0].attr("stroke",b)};b.SinkView=c;return b}(NAND||{});NAND=function(b){function c(a,b){this.id=a;this.kind="source";this.value=b;this.outputs=[]}c.prototype.connect=function(a){this.outputs.push(a);a.inputs.push(this)};c.prototype.traverse=function(a,b,c){a(this,b,c);this.outputs.map(function(d){d.traverse(a,b,c+1)})};c.prototype.evaluate=function(){return this.value};c.prototype.toggle=function(){this.value=!this.value};b.Source=c;return b}(NAND||{});NAND=function(b){function c(a,b){this.node=a;this.model=b;this.paths=[];this.labels=[];this.outlines=[]}c.prototype.render=function(a){var c=this.model.value,m=this.model.x,d=this.model.y,h="?"==c?"black":"0"==c?"#a00":"#0a0";this.outlines[0]=a.rect(m-7,d-7,14,14).attr("stroke",h).attr("fill","white").drag(b.makeMove(this),b.start,b.up(this));this.labels[0]=a.text(m,d,c).attr("stroke",h).click(this.model.click.bind(this)).drag(b.makeMove(this),b.start,b.up(this));this.labels[0].node.setAttribute("class",
"input")};c.prototype.update=function(){var a=this.model.value,b="?"==a?"black":"0"==a?"#a00":"#0a0";this.labels[0].attr("text",a).attr("stroke",b);this.outlines[0].attr("stroke",b)};b.SourceView=c;return b}(NAND||{});NAND=function(b){function c(a){this.model=a;this.outlines=[];this.labels=[];this.paths=[]}c.prototype.render=function(a){var c=this.model.heavyStrokeWidth,m=this.model.lightStrokeWidth,d=this.model.width/2,h=this.model.height/2,e=this.model.x-d,f=this.model.y-h,g="?"==this.model.inputs[0],k=.4*this.model.width,l=2*this.model.width/3,r=.15*this.model.width;this.paths[0]=(new b.PathBuilder).moveTo(e,f).lineTo(e+k,f).arc(l,l,0,0,1,e+this.model.width-r,f+h).arc(l,l,0,0,1,e+k,f+this.model.height).lineTo(e,
f+this.model.height).toPath(a).attr({fill:"white","stroke-width":c*(g?.5:1),"stroke-dasharray":g?"-":""}).drag(b.makeMove(this),b.start,b.up(this));this.paths[1]=(new b.PathBuilder).moveTo(e,f).arc(k,k,0,0,1,e,f+this.model.height).toPath(a).attr({fill:"white","stroke-width":c*(g?.5:1),"stroke-dasharray":g?"-":""});this.paths[2]=(new b.PathBuilder).moveTo(e-5,f).arc(k,k,0,0,1,e-5,f+this.model.height).toPath(a).attr({fill:"white","stroke-width":c*(g?.5:1),"stroke-dasharray":g?"-":""});g=.05*this.model.width;
c=e+d+h+g+c/2;h=f+h;d=.2*this.model.height;k=.3*this.model.width;this.paths[3]=(new b.PathBuilder).moveTo(e+k-1-.5*k,f+d).lineTo(e-k,f+d).toPath(a).attr("stroke-width",m);l="?"==this.model.inputs[0]?"black":"0"==this.model.inputs[0]?"#a00":"#0a0";this.outlines[0]=a.circle(e-k,f+d,7.5).attr("fill","white").attr("stroke",l);this.labels[0]=a.text(e-k,f+d,this.model.inputs[0]).attr("stroke",l);this.labels[0].node.setAttribute("class","intermediate");this.paths[4]=(new b.PathBuilder).moveTo(e+k-1-.5*k,
f+this.model.height-d).lineTo(e-k,f+this.model.height-d).toPath(a).attr("stroke-width",m);l="?"==this.model.inputs[1]?"black":"0"==this.model.inputs[1]?"#a00":"#0a0";this.outlines[1]=a.circle(e-k,f+this.model.height-d,7.5).attr("fill","white").attr("stroke",l);this.labels[1]=a.text(e-k,f+this.model.height-d,this.model.inputs[1]).attr("stroke",l);this.labels[1].node.setAttribute("class","intermediate");this.outputWire={x:c+k,y:h};this.outlines[3]=(new b.PathBuilder).moveTo(c+g,h).lineTo(c+k,h).toPath(a).attr("stroke-width",
m);null!=this.model.output&&(l="?"==this.model.output?"black":"0"==this.model.output?"#a00":"#0a0",this.outlines[2]=a.circle(c+k,h,7.5).attr("fill","white").attr("stroke",l),this.labels[2]=a.text(c+k,h,this.model.output).attr("stroke",l),this.labels[2].node.setAttribute("class","intermediate"))};c.prototype.update=function(){var a="?"==this.model.inputs[0]?"black":"0"==this.model.inputs[0]?"#a00":"#0a0";this.labels[0].attr("text",this.model.inputs[0]).attr("stroke",a);this.outlines[0].attr("stroke",
a);a="?"==this.model.inputs[1]?"black":"0"==this.model.inputs[1]?"#a00":"#0a0";this.labels[1].attr("text",this.model.inputs[1]).attr("stroke",a);this.outlines[1].attr("stroke",a);a="?"==this.model.output?"black":"0"==this.model.output?"#a00":"#0a0";this.labels[2].attr("text",this.model.output).attr("stroke",a);this.outlines[2].attr("stroke",a);a="?"==this.model.inputs[0];this.paths[0].attr("stroke-dasharray",a?"-":"");this.paths[1].attr("stroke-dasharray",a?"-":"");this.paths[2].attr("stroke-dasharray",
a?"-":"");this.paths[3].attr("stroke-dasharray",a?"-":"");this.paths[4].attr("stroke-dasharray",a?"-":"")};b.XorView=c;return b}(NAND||{});NAND=function(b){function c(a){return a.reduce(function(a,b){return a&&b})}function a(a){return a.reduce(function(a,b){return a||b})}function t(a){return a.reduce(function(a,b){return a^b})}function m(a){this.id=a;this.inputs=[];this.outputs=[];this.wires=[]}function d(a,b,c){0>g?g=0:g>=c&&(g=c-1);a.traverse(function(a,d,f){b.map(function(b){var d=b.node,e=b.view;if(d.id==a.id){var h=f>g;switch(d.kind){case "gate":d.inputs.map(function(a,b){e.model.inputs[b]=h?"?":a.evaluate()?"1":"0"});e.model.output=
h?"?":d.evaluate()?"1":"0";e.update();break;case "sink":e.model.value=g<c-1?"?":d.evaluate()?"1":"0",e.update()}}})});document.getElementById("time").textContent="t = "+g}function h(h){e=new Raphael(0,0,window.innerWidth,window.innerHeight);var p=document.getElementById("controls");p.style.left=e.width/2-p.clientWidth/2+"px";p.style.top=e.height/2-p.clientHeight/2-150+"px";var p=0,x=new b.Source(p++,!1),y=new b.Source(p++,!1),z=new b.Source(p++,!1),A=new b.Sink(p++),B=new b.Sink(p++),C=new b.Sink(p++);
new b.Delay(p++);new b.Delay(p++);new b.Delay(p++);var q=new b.FanOut(p++),v=new b.FanOut(p++);new b.FanOut(p++);new b.FanOut(p++);var w=new b.Gate(p++,"xor",t),u=new b.Gate(p++,"and",c);new b.Gate(p++,"xor",t);new b.Gate(p++,"and",c);new b.Gate(p++,"or",a);x.connect(q);q.connect(A);y.connect(v);v.connect(B);q.connect(u);v.connect(u);u.connect(w);z.connect(w);w.connect(C);f=new m(p++);f.inputs=[x,y,z];f.outputs=[A,B];k=f.layout(e);r=k.nodeViews;l=k.maxDepth;d(f,r,l);var n=document.getElementById("slider");
n.max=l-1;h&&(document.getElementById("forward").addEventListener("click",function(){g++;d(f,r,l);n.value=g},!1),document.getElementById("backward").addEventListener("click",function(){g--;d(f,r,l);n.value=g},!1),document.getElementById("slider").addEventListener("input",function(){g=this.value;d(f,r,l);n.value=g}))}var e,f;b.makeMove=function(a){return function(b,c){for(var d=0;d<a.paths.length;d++){var e=a.paths[d];null!=e&&e.translate(b-this.tx,c-this.ty)}for(d=0;d<a.labels.length;d++)e=a.labels[d],
null!=e&&e.translate(b-this.tx,c-this.ty);for(d=0;d<a.outlines.length;d++)e=a.outlines[d],null!=e&&e.translate(b-this.tx,c-this.ty);this.tx=b;this.ty=c;a.model.viewModel.dx=b;a.model.viewModel.dy=c;f.layoutWires()}};b.start=function(){this.ty=this.tx=0};b.up=function(a){return function(){a.model.x+=a.model.viewModel.dx;a.model.y+=a.model.viewModel.dy;a.model.viewModel.dx=0;a.model.viewModel.dy=0}};m.prototype.traverse=function(a){this.inputs.map(function(b,c){b.traverse(a,c,0)})};m.prototype.layout=
function(a){var c=null,e=null;this.traverse(function(a,b,d){if(null==c||b>c)c=b;if(null==e||d>e)e=d});var f=[];this.traverse(function(a,b,c){a.seen||(a.seen=!0,f.push({node:a,row:b,column:c,dx:0,dy:0}))});for(var g=0,h=0;h<f.length;h++){var k=f[h],l=k.node;k.row+=g;if("sink"==l.kind)k.column=e;else if(null!=l.inputs){var q=function(a){if(null!=a)for(var b=0;b<f.length;b++){var c=f[b];if(c.node.id==a.id)return c}return null},m=q(l.inputs[0]),l=q(l.inputs[1]);null!=m&&null!=l?(k.row=Math.round((m.row+
l.row)/2),g++):null!=m&&null==l&&(k.row=m.row)}}for(l=!0;l;)for(l=!1,g=[],h=0;h<f.length;h++){k=f[h];for(m=0;m<g.length;m++)if(g[m].row==k.row&&g[m].column==k.column&&g[m].node.id!=k.node.id){k.column++;l=!0;break}if(l)break;g.push(k)}g=a.width/2-90*(e-1)/2;m=a.height/2-60*(c-1)/2;this.dx=90;this.dy=60;this.cx=g;this.cy=m;this.models=f;this.layoutWires();for(var t=this,u=[],h=0;h<f.length;h++){var k=f[h],n=g+90*k.column,r=m+60*k.row,l=k.node,q=null;switch(l.kind){case "source":n={viewModel:k,x:n,
y:r,value:k.node.value?"1":"0",click:function(){this.node.toggle();this.model.value=this.node.value?"1":"0";this.update();d(t,u,e)}};q=new b.SourceView(l,n);k.options=n;q.render(a);break;case "sink":n={viewModel:k,x:n,y:r,value:l.evaluate()?"1":"0"};q=new b.SinkView(n);k.options=n;q.render(a);break;case "delay":q=new b.DelayView({x:n,y:r});q.render(a);break;case "fanout":q=new b.FanOutView({x:n,y:r});q.render(a);break;case "gate":n={viewModel:k,id:l.id,x:n,y:r,width:60,height:40,heavyStrokeWidth:2,
lightStrokeWidth:1.25,inputs:"not"==l.gate?[l.inputs[0].evaluate()?"1":"0"]:[l.inputs[0].evaluate()?"1":"0",l.inputs[1].evaluate()?"1":"0"],output:l.evaluate()?"1":"0"};k.options=n;switch(l.gate){case "not":q=new b.NotView(n);break;case "nand":q=new b.NandView(n);break;case "and":q=new b.AndView(n);break;case "nor":q=new b.NorView(n);break;case "or":q=new b.OrView(n);break;case "xor":q=new b.XorView(n);break;default:throw"gate";}q.render(a);break;default:throw"kind";}null!=q&&u.push({node:l,view:q})}return{nodeViews:u,
maxDepth:e}};m.prototype.layoutWires=function(){for(var a=0;a<this.wires.length;a++)this.wires[a].remove();this.wires=[];for(var c=this.dx,d=this.dy,f=this.cx,l=this.cy,k=this,a=0;a<this.models.length;a++){var g=this.models[a],h=g.node;null!=h.outputs&&h.outputs.map(function(a){for(var h=[],m=0;m<k.models.length;m++){var r=k.models[m];r.node.id==a.id&&h.push(r)}if(1!=h.length)throw console.log(h),"outputs";a=h[0];var h=g.options?g.options.x+g.dx:f+g.column*c,m=g.options?g.options.y+g.dy:l+g.row*d,
r=a.options?a.options.x+a.dx:f+a.column*c,n=a.options?a.options.y+a.dy:l+a.row*d,t="gate"==a.node.kind?-48:0;a="gate"==a.node.kind?-5:0;k.wires.push((new b.PathBuilder).moveTo(h,m).lineTo(r+t,m).lineTo(r+t,n<m?n-a:n+a).toPath(e).toBack())})}};var g=0,k,l,r;window.addEventListener("load",function(){h(!0)});window.addEventListener("resize",function(){e.clear();h(!1)});return b}(NAND||{});
